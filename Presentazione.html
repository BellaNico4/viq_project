<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Presentazione ricerca1</title>
    <link rel="stylesheet" href="foglioDiStile.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script></head>
</head>
<body>
<div class="container">
    <div class="theHeaderCentrale">
    <h1>VIQ PROJECT</h1>
    <h2>a.a. 2018/2019</h2>
    <h2 id="nome1">Matteo Boffa</h2>
    <h2 id="nome2">Nicol&oacute; Bellarmino</h2>
    </div>

    <div class="Motivazioni">
        <script src="pr_functions.js"></script>

        <script>
            window.onload = function () {
                let data;
                //Async request : defining "success" function
                loadASync("serie_a_stats.csv", csv => {
                    //CREAZIONE TABELLA
                    data = csvParse(csv);
                    console.log(data);
                    let columns = ["N", "Team", "M", "W", "D", "L", "G", "GA", "PTS", "xG", "xGA", "xPTS"];
                    document.getElementById("myTable").append(tableToHtmlElement(noPlusNoMinus(data, columns)));

                    //CREAZIONE GRAFICO 1
                    let nomeSquadre = [];
                    for(let i=0;i<filterData(data,['Team']).length;i++){
                        nomeSquadre.push((filterData(data,['Team'])[i]).Team);
                    }
                    let punti = [];
                    for(let i=0;i<filterData(data,['PTS']).length;i++){
                        punti.push((filterData(data,['PTS'])[i]).PTS);
                    }
                    let expectedPoints = [];
                    for(let i=0;i<noPlusNoMinus(data,['xPTS']).length;i++){
                        expectedPoints.push((noPlusNoMinus(data,['xPTS'])[i]).xPTS);
                    }
                    var trace1=
                        {
                            x: nomeSquadre,
                            y: punti,
                            type: 'bar',
                            name: 'Punti'
                        };
                    var trace2=
                        {
                            x: nomeSquadre,
                            y: expectedPoints,
                            type: 'bar',
                            name: 'ExpectedPoints'
                        };
                    var datiGrafico = [trace1,trace2];
                    var layout = {barmode:'group'};
                    Plotly.newPlot('myDiv', datiGrafico, layout);

                    //GRAFICO 2

                    let datiSecondo = noPlusNoMinus(data,['Team','xPTS']);
                    datiSecondo.sort((a,b)=>b.xPTS-a.xPTS);

                    let nomeSquadre1=[];
                    for(let i=0;i<filterData(datiSecondo,['Team']).length;i++){
                        nomeSquadre1.push((filterData(datiSecondo,['Team'])[i]).Team);
                    }
                    expectedPoints=[];
                    for(let i=0;i<noPlusNoMinus(datiSecondo,['xPTS']).length;i++){
                        expectedPoints.push((noPlusNoMinus(datiSecondo,['xPTS'])[i]).xPTS);
                    }
                    var data2=[
                        {
                            x: expectedPoints,
                            y: nomeSquadre1,
                            orientation: 'h',
                            type: 'bar'
                        }
                    ]
                    Plotly.newPlot('myDiv2', data2);

                    //GRAFICO 3

                    var data3=[
                        {
                            x: punti,
                            y: nomeSquadre,
                            orientation: 'h',
                            type: 'bar'
                        }
                    ]
                    Plotly.newPlot('myDiv3', data3);
                })
            }
        </script>
        <h3>Classifica Serie A 2018/2019</h3>
        <div id = "myTable"></div>
        </div>

    <div class="Statistiche">
     <h3>Motivazioni:</h3>
        <p>Sono diversi i motivi che ci hanno spinto ad intraprendere questa piccola ricerca. Innanzitutto
            il desiderio di dare, nel nostro piccolo, il contributo ad un approccio pi&uacute; scientifico all'analisi
            calcistica, troppo spesso invece trattata alla stregua del chiacchierio da bar. Altri sport, come basket
            e baseball, hanno gi&aacute; da tempo sposato questo metodo e riteniamo che sia giunto il tempo che anche il
            calcio segua questa via. Segue poi il tentativo di spiegare (e, da tifosi, di spiegarci), con l'ausilio
            di alcune statistiche che spiegheremo in seguito, quale siano le ragioni per cui la Juventus abbia, a fronte
            di una rosa di grandissimo valore, fallito nella met&aacute; di quelli che erano inizialmente gli obiettivi
            stagionali e deluso, parlando di qualit&aacute di gioco espresso, negli altri.</p>
    <h3>Statistiche utilizzate</h3>
        <p>Come anticipato nell'introduzione, queste saranno le principali statistiche che utilizzeremo:</p>
        <p>Indici per ciascuna partita:</p>
        <ul>
            <li>Goal segnati</li>
            <li>Goal subiti</li>
            <li>Tiri effettuati</li>
            <li>Tiri concessi</li>
            <li>Contrasti effettuati</li>
            <li>Tackle vinti (percentage)</li>
            <li>Palle intercettate</li>
            <li>Falli effettuati</li>
            <li>Passaggi eseguiti</li>
            <li>Passaggi eseguiti con successo</li>
            <li>Possesso palla</li>
        </ul>
        <p>A cui si aggiungono altri 3 parametri molto utilizzati nel settore, ovvero:</p>
        <ul>
            <li>Expected Goal (xG): si associa un 'coefficiente di pericolosit√†' (assegnato da analisti dopo aver analizzato un grande campione di tentativi simili)
                a ciascun tiro effettuato durante la partita; tutti questi addendi vengono poi sommati a rappresentare un indicatore di quanti
                goal avrebbe 'meritato' di segnare la squadra</li>
            <li>Expected Goal against (xGa): indice speculare a quello precedente e rappresenta i goal potenziali a fronte delle occasioni concesse</li>
            <li>Key passes: passaggi in seguito ai quali &eacute; seguito un tiro verso la porta avversaria</li>
        </ul>
        <p>Indici sull'intero campionato</p>
        <ul>
            <li>Punti ottenuti</li>
            <li>Expected points: si vanno a tabulare le differenze tra xG e xGa per ogni partita e si assegna ad ogni valore un determinato numero di punti guadagnati</li>
        </ul>
     </div>

     <div  class="Esempio">
        <h3>Esempio</h3>
        <p>Vediamo subito un esempio:</p>
         <div style="border: solid black; padding: 1ex 1em; margin-bottom: 2ex">
         <h4>Confronto punti-expected points per ciascuna squadra</h4>
         <div id="myDiv">
         </div>
             <h4 style="color: red;">Commento:</h4>
             <p>Quanto rappresentato sopra ha una duplice valenza:</p>
             <ol>
                 <li> serve ad esemplificare la statistica degli 'expected points'
                     in modo che chi visiona la pagina vi prenda familiarit&aacute. Osservando il rendimento
                     reale ed 'atteso' di ciascuna squadra si pu&oacute; notare come alcune abbiano capitalizzato
                     meglio le occasioni loro concesse mentre altre, la Fiorentina per esempio, abbiano prodotto
                     molto pi&uacute; di quello che effettivamente hanno poi raccolto</li>
                 <li> traspare gi&aacute; una delle tematiche che ci accompagneranno nella nostra analisi successiva:
                     che strana stagione &eacute; stata quella dei Campioni d'Italia? </li>
             </ol>
         </div>
         <div style="text-align: center; border: solid black; margin-top: 2ex; ">
             <h4 style="text-align: left;padding: 2ex 1em">Confronto classifica usando real points ed expected points</h4>
             <div style="display: block">
                <div style="padding: 1ex 1em; display: inline-block; float: right;width: 45%">
                    <h4>Classifica Serie A (expected points)</h4>
                    <div id="myDiv2">
                    </div>
                </div>
                <div style="padding: 1ex 1em; display: inline-block; float: left;width: 45%">
                    <h4>Classifica Serie A (real points)</h4>
                    <div id="myDiv3">
                    </div>
                 </div>
             </div>
             <div style="display: block;  padding: 2ex 1em">
                <h4 style="color: red;">Commento:</h4>
                 <p>A confermare quanto detto nel punto 1 dell'esempio precedente possiamo notare che, a seconda dell'indicatore scelto,
                     le classifiche sarebbe ben diverse: </p>
                 <p>il Napoli sarebbe infatti primo classificato (con margine di una partita),
                     la Juventus rischierebbe il terzo posto e la lotta salvezza assumerebbe dei connotati clamorosi</p>
             </div>
         </div>
     </div>

     <div class="Nuova_Pagina">
        <div class="Testo">
        <p>Terminata questa necessaria introduzione, passiamo ora all'analisi della stagione bianconera.</p>
        <p>Cliccare sulla freccia avanti per passare alla pagina successiva</p>
        </div>
        <img src="Freccia.jpg" alt="Freccia cliccabile" usemap="#areeCliccabili" width="50" height="50"/>
        <map name="areeCliccabili">
            <area shape="rect" coords="0,0,50,50" href="Statistiche_reparto_con_reparto.html" />
        </map>
     </div>

    <div  class="theFooter">
    <p>Per avere pi&uacute; informazioni sugli indici xG, xGa e Expected Points si consiglia la visione dei seguenti link:</p>
    <ul>
        <li><a href="https://www.ultimouomo.com/cosa-sono-gli-expected-goals/">L'Ultimo Uomo</a></li>
        <li><a href="https://www.modernfitba.com/blogs/2018/9/8/re-introducing-expected-points-xpxpoints">Modernfitba</a></li>
    </ul>
    </div>

</div>
</body>
</html>